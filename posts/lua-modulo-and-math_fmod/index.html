<!doctype html><html lang=en><meta charset=utf-8><meta name=generator content="Hugo 0.83.1"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><title>C 和 Lua 取模运算的异同&nbsp;&ndash;&nbsp;Glaumar's Blog</title><link rel=stylesheet href=/css/core.min.78719e8336f9f7af67a9d03a6d2bcd57bbe5df387d3b75b34078aaa427279d260421eebb4123000aba27599bfce6538c.css integrity=sha384-eHGegzb5969nqdA6bSvNV7vl3zh9O3WzQHiqpCcnnSYEIe67QSMACronWZv85lOM><meta name=twitter:card content="summary"><meta name=twitter:title content="C 和 Lua 取模运算的异同"><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=/><span class="site name">Glaumar's Blog</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=/categories/>Categories</a><a class="nav item" href=/tags/>Tags</a><a class="nav item" href=/about>About</a></nav></div></span></div><div class="site slogan"><span class=title>#! /because/we/can</span></div></section><section id=content><div class=article-container><section class="article header"><h1 class="article title">C 和 Lua 取模运算的异同</h1><p class="article date">Saturday, May 2, 2020</p></section><article class="article markdown-body"><h2 id=c-取模>C 取模</h2><p>C语言的取模运算符（%）仅支持整数，定义如下：</p><p>a % b == a - ((a / b) * b)</p><p>对于 <code>a/b</code> ， C语言会自动截断计算结果的小数部分， C99规定了"趋零截断"，举个例子 <code>2.14</code> 会截断为 <code>2</code> ， <code>-2.14</code> 会截断为 <code>-2</code> 。</p><p>简单来讲，C语言取模结果的符号（正数还是负数）与 <code>a</code> 的符号相同</p><h2 id=lua-取模>Lua 取模</h2><p>Lua（当前版本为5.3）取模操作有两种 <code>%</code> 和 <code>math.fmod()</code> ，稍微有一点区别</p><ul><li><p><code>math.fmod(a, b)</code> 相当于 <strong>C语言的</strong> <code>a%b</code> ，但是支持浮点数</p></li><li><p>Lua的取模运算符（%）支持整数和浮点数，定义如下：</p><p>a % b == a - ((a // b) * b)</p></li></ul><p><code>//</code> 在lua中称为<strong>floor除法（floor division）</strong>，会将运算结果向负无穷取整（rounds the quotient towards minus infinity），举个例子 <code>2.14</code> 会截断为 <code>2.0</code> ， <code>-2.14</code> 会截断为 <code>-3.0</code></p><p>需要注意的两点</p><ol><li>Lua中 <code>a%b</code> 的结果的符号与 <code>b</code> 的符号相同</li><li>对于浮点数，<code>x - x%0.01</code> 会保留两位小数，<code>x - x%0.001</code> 会保留三位小数，以此类推</li></ol><hr><p>参考：</p><ul><li><p>《C Primer Plus（第6版）》</p></li><li><p>《Lua 程序设计（第4版）》</p></li><li><p><a href=https://stackoverflow.com/questions/7077036/math-fmod-always-euqls-math-mod target=_blank rel="noopener noreferrer">Stack Overflow - math.fmod always euqls math.mod?</a></p></li><li><p><a href=https://www.cnblogs.com/Fallever/p/6880710.html target=_blank rel="noopener noreferrer">博客园 - lua取模运算math.fmod和% 的区别</a></p></li></ul></article><section class="article labels"><a class=tag href=/tags/lua/>lua</a><a class=tag href=/tags/c/>c</a></section></div><div class="article bottom"><section class="article navigation"><p><a class=link href=/posts/convert-dos-file-to-unix-format/><span class="iconfont icon-article"></span>将windows文本文件转换为linux格式</a></p><p><a class=link href=/posts/rpn-and-shunting-yard/><span class="iconfont icon-article"></span>逆波兰表达式和调度场算法</a></p></section></div></section><section id=footer><div class=footer-wrap><p class=copyright>©2021 glaumar.</p><p class=powerby><span>Powered&nbsp;by&nbsp;</span><a href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a><span>&nbsp;&&nbsp;</span><a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank rel="noopener noreferrer">Notepadium</a></p></div></section></body></html>