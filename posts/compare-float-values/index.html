<!doctype html><html lang=en><meta charset=utf-8><meta name=generator content="Hugo 0.83.1"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><title>浮点数比较&nbsp;&ndash;&nbsp;Glaumar's Blog</title><link rel=stylesheet href=/css/core.min.78719e8336f9f7af67a9d03a6d2bcd57bbe5df387d3b75b34078aaa427279d260421eebb4123000aba27599bfce6538c.css integrity=sha384-eHGegzb5969nqdA6bSvNV7vl3zh9O3WzQHiqpCcnnSYEIe67QSMACronWZv85lOM><meta name=twitter:card content="summary"><meta name=twitter:title content="浮点数比较"><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=/><span class="site name">Glaumar's Blog</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=/categories/>Categories</a><a class="nav item" href=/tags/>Tags</a><a class="nav item" href=/about>About</a></nav></div></span></div><div class="site slogan"><span class=title>#! /because/we/can</span></div></section><section id=content><div class=article-container><section class="article header"><h1 class="article title">浮点数比较</h1><p class="article date">Tuesday, August 18, 2020</p></section><article class="article markdown-body"><p>计算机中的浮点数并不精确, 不能直接用 <code>==</code> 比较两个浮点数是否相等, 应在可接受的范围定义一个比较小的数 <code>epsilon</code> , 两个浮点数之差小于 <code>epsilon</code> 即认为他们相等</p><p>C</p><div class=highlight><pre class=chroma><code class=language-c data-lang=c><span class=cp>#include</span> <span class=cpf>&lt;float.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;math.h&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;stdbool.h&gt;</span><span class=cp>
</span><span class=cp></span>
<span class=kt>bool</span> <span class=nf>almost_equal</span><span class=p>(</span><span class=k>const</span> <span class=kt>double</span> <span class=n>a</span><span class=p>,</span> <span class=k>const</span> <span class=kt>double</span> <span class=n>b</span><span class=p>){</span>
    <span class=k>return</span> <span class=p>(</span><span class=n>fabs</span><span class=p>(</span><span class=n>a</span> <span class=o>-</span> <span class=n>b</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>DBL_EPSILON</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div><p>C++</p><div class=highlight><pre class=chroma><code class=language-cpp data-lang=cpp><span class=cp>#include</span> <span class=cpf>&lt;cmath&gt;</span><span class=cp>
</span><span class=cp>#include</span> <span class=cpf>&lt;limits&gt;</span><span class=cp>
</span><span class=cp></span>
<span class=kt>bool</span> <span class=nf>almost_equal</span><span class=p>(</span><span class=k>const</span> <span class=kt>double</span> <span class=n>a</span><span class=p>,</span> <span class=k>const</span> <span class=kt>double</span> <span class=n>b</span><span class=p>){</span>
    <span class=k>return</span> <span class=p>(</span><span class=n>fabs</span><span class=p>(</span><span class=n>a</span> <span class=o>-</span> <span class=n>b</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>std</span><span class=o>::</span><span class=n>numeric_limits</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;::</span><span class=n>epsilon</span><span class=p>());</span>
<span class=p>}</span>
</code></pre></div><p>Qt</p><div class=highlight><pre class=chroma><code class=language-cpp data-lang=cpp><span class=cp>#include</span> <span class=cpf>&lt;QtGlobal&gt;</span><span class=cp>
</span><span class=cp></span>
<span class=n>qFuzzyCompare</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>);</span>
</code></pre></div><p>Javascript/QML</p><div class=highlight><pre class=chroma><code class=language-javascript data-lang=javascript><span class=kd>function</span> <span class=nx>almost_equal</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span>
	<span class=k>return</span> <span class=p>(</span><span class=nb>Math</span><span class=p>.</span><span class=nx>abs</span><span class=p>(</span><span class=nx>a</span> <span class=o>-</span> <span class=nx>b</span><span class=p>)</span> <span class=o>&lt;</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>pow</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=o>-</span><span class=mi>52</span><span class=p>))</span>
<span class=p>}</span>
</code></pre></div></article><section class="article labels"><a class=tag href=/tags/c/>c</a><a class=tag href=/tags/cpp/>cpp</a><a class=tag href=/tags/qt/>qt</a><a class=tag href=/tags/js/>js</a><a class=tag href=/tags/algorithm/>algorithm</a></section><section class="article author"><div class=details><a class=item href=https://github.com/glaumar target=_blank rel="noopener noreferrer"><span class="iconfont icon-github"></span>&nbsp;glaumar</a></div></section></div><div class="article bottom"><section class="article navigation"><p><a class=link href=/posts/git/><span class="iconfont icon-article"></span>Git</a></p><p><a class=link href=/posts/sleep-for-and-chrono-duration/><span class="iconfont icon-article"></span>this_thread::sleep_for()和chrono::duration, ratio;</a></p></section></div></section><section id=footer><div class=footer-wrap><p class=copyright>©2021 glaumar.</p><p class=powerby><span>Powered&nbsp;by&nbsp;</span><a href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a><span>&nbsp;&&nbsp;</span><a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank rel="noopener noreferrer">Notepadium</a></p></div></section></body></html>